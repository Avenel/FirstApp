<h1>Neu anlegen</h1>
<%= link_to "zurÃ¼ck", "/buergschaften" %>

<%= form_tag({:action => "save"}, :id=>"newForm") do %>

  <p> 
    <%= label_tag "Buergschafter:" %>
    <%= text_field_tag :pnrB %>
    <%= link_to "Suchen...", "#searchOZBPersonFrame", :id => "searchBFrame" %>
  </p>
  
  <p>
    <%= label_tag "Gesellschafter:" %>  
    <%= text_field_tag :mnrG %>  
    <%= link_to "Suchen...", "#searchOZBPersonFrame", :id => "searchGFrame" %>
  </p>  
  
  <p>
    <%= label_tag "sichAbDatum:" %>
    <%= text_field_tag :sichAbDatum %>  
  </p>
  
  <p>
    <%= label_tag "Konto-Nr.:" %>
    <%= text_field_tag :ktoNr %>  
    <%= link_to "Suchen...", "#searchKtoNrFrame", :id => "searchKtoNr" %> 
  </p>
  
  <p>
    <%= label_tag "sichEndDatum:" %>
    <%= text_field_tag :sichEndDatum %>  
  </p>
  
  <p>
    <%= label_tag "sichBetrag:" %>
    <%= text_field_tag :sichBetrag %>  
  </p>
  
  <p>
    <%= label_tag "sichKurzBez:" %>
    <%= text_field_tag :sichKurzBez %>  
  </p>
  
  <%= link_to_function "Ok", "this.form.submit()", :onclick => "$('#newForm').submit(); return false;" %>	

<% end %>


<div style="display:none">
  <div id="searchKtoNrFrame">
    <div id="konten"><%= render 'application/suche_konten' %></div>  
  </div>
</div>

<div style="display:none">
  <div id="searchOZBPersonFrame">
    <div id="personen"><%= render 'application/suche_ozb_personen' %></div>  
  </div>
</div>


<script>

  var insertId = "#pnrB";

  $("#searchBFrame").click(function(){
    insertId = "#pnrB";
  });
  
  $("#searchGFrame").click(function(){
    insertId = "#mnrG";
  });

  $(document).ready(function() {
    $("#searchKtoNr").fancybox();
    $("#searchBFrame").fancybox();
    $("#searchGFrame").fancybox();    
  });
  
  $(function() {
    var availableTagsB = [
      <% tags = String.new %>
      <% Person.all.each do |person| %>
        <% if person.rolle.to_str == 'B' then %>
          <% tags += "'" + person.pnr.to_s + "'" + "," %>
        <% end %>
      <% end %>
      <%= tags.chop %>
      ];
    $( "#pnrB" ).autocomplete({
      source: availableTagsB
    });
    
    var availableTagsG = [
      <% tags = String.new %>
      <% Person.all.each do |person| %>
        <% if person.rolle.to_str == 'G' then %>
          <% tags += "'" + person.pnr.to_s + "'" + "," %>
        <% end %>
      <% end %>
      <%= tags.chop %>
      ];
    $( "#mnrG" ).autocomplete({
      source: availableTagsG
    });
    
    
    var availableTagsKonto = [
      <% tags = String.new %>
      <% OZBKonto.all.each do |konto| %>
          <% tags += "'" + konto.ktoNr.to_s + "'" + "," %>
      <% end %>
      <%= tags.chop %>
      ];
    $( "#ktoNr" ).autocomplete({
      source: availableTagsKonto
    });
    
  });
  
</script>

<script>
  $(function() {
    $( "#sichEndDatum" ).datepicker({
      dateFormat: 'yy-mm-dd'
    });
  });
  
  $(function() {
    $( "#sichAbDatum" ).datepicker({
      dateFormat: 'yy-mm-dd'
    });
  });
</script>
