<h1>Buergschaften</h1>

<table class="table">
  <tr>
    <th>Buergschafter</th>
    <th>Gesellschafter</th>
    <th>Konto-Nr.</th>
    <th>sichAbDatum</th>
    <th>sichEndDatum</th>    
    <th>sichBetrag</th>
    <th>sichKurzBez</th>
    <th />
    <th />
  </tr>

  <% @buergschaften.each do |buergschaft| %>
  <% buergschafter = Person.where(:pnr => buergschaft.pnrB).first %>
  <% gesellschafter = Person.where( :pnr => OZBPerson.where(:mnr => buergschaft.mnrG).first.ueberPnr ).first   %>
    <tr>
      <% if !buergschafter.nil? then %>
        <td><%= buergschafter.name.to_s + ", " + buergschafter.vorname.to_s %></td>
      <% else %>
        <td>nicht gefunden</td>
      <% end %>
      <% if !gesellschafter.nil? then %>
        <td><%= gesellschafter.name.to_s + ", " + gesellschafter.vorname.to_s %></td>
      <% else %>
        <td>nicht gefunden</td>
      <% end %>
      <td><%= buergschaft.ktoNr %></td>
      <td><%= buergschaft.sichAbDatum %></td>
      <td><%= buergschaft.sichEndDatum %></td>      
      <td><%= buergschaft.sichBetrag %></td>
      <td><%= buergschaft.sichKurzBez %></td>
      <% edit_link = "/buergschaften/" + buergschaft.pnrB.to_s + "/" + buergschaft.mnrG.to_s %>
      <% delete_link = "/buergschaften/" + buergschaft.pnrB.to_s + "/" + buergschaft.mnrG.to_s + "/delete" %>
      <td><%= link_to "Editieren", edit_link %></td>
      <td><%= link_to "Löschen", delete_link %></td>
    </tr>
  
  <% end %>
</table>

<!-- Seitennavigation -->
<div class="paginateBox" >
  <%= will_paginate @buergschaften %> 
</div>

<%= link_to "Neue Buergschaft hinzufügen", "/buergschaften/new" %>

