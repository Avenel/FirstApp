<h1>Person anlegen</h1>

	<%= form_tag({:action => "save"}, :id=>"newForm") do %>	
	<table class="table">
   	<tr>
		  <td><%= label_tag "Name:" %></td>
		  <td><%= text_field_tag :name %></td>  
	  </tr>
	
	  <tr>
		  <td><%= label_tag "Vorname:" %></td>
		  <td><%= text_field_tag :vorname %></td>  
	  </tr>
	    
	  <tr>
		  <td><%= label_tag "Geburtsdatum:" %>  </td>
		  <td><%= text_field_tag :gebDatum %></td>
	  </tr>  
	    
	  <tr>
		  <td><%= label_tag "Straße:" %></td>
		  <td><%= text_field_tag :strasse %></td>
	  </tr>
	
	  <tr>
		  <td><%= label_tag "PLZ:" %></td>
		  <td><%= text_field_tag :plz %></td>  
	  </tr>
	
	  <tr>
		  <td><%= label_tag "Ort:" %></td>
		  <td><%= text_field_tag :ort %>  </td>
	  </tr>
	
	  <tr>
		  <td><%= label_tag "Telefon:" %></td>
		  <td><%= telephone_field_tag :telefon %>  </td>
	  </tr>
	
	  <tr>
		  <td><%= label_tag "Fax:" %></td>
		  <td><%= telephone_field_tag :fax %></td>  
	  </tr>
	
	  <tr>
		  <td><%= label_tag "Email:" %></td>
		  <td><%= email_field_tag :email %></td>  
	  </tr>
  <!--	
	  <tr>
		  Bankdaten:
	  </tr>
	
	  <tr>
		  <%= label_tag "Kontoinhaber:" %>
		  <%= text_field_tag :kontoinhaber %>  
	  </tr>
	
	  <tr>
		  <%= label_tag "Kontonummer:" %>
		  <%= text_field_tag :kontonr %>  
	  </tr>
	
	  <tr>
		  <%= label_tag "BLZ:" %>
		  <%= text_field_tag :blz %>  
	  </tr>	
	
	  <tr>
		  <%= label_tag "Bankname:" %>
		  <%= text_field_tag :bankname %>  
	  </tr>
  -->	

	  <tr>
      <td><%= label_tag "Rolle:" %></td>
      <td><%= select_tag 'rolle', options_for_select(@Rollen), { :onChange => "show_role()" } %></td>
    </tr>
    </table>	
    <div id="Student">
      <table style="margin: 10px auto;">
    	<tr>
			  <td><%= label_tag "Ausbildungsbezeichnung:" %></td>
			  <td><%= text_field_tag :ausbildBez %></td>  
		  </tr>

    	<tr>
			  <td><%= label_tag "Institut:" %></td>
			  <td><%= text_field_tag :institutName %></td>  
		  </tr>

    	<tr>
			 <td><%= label_tag "Studienort:" %></td>
			 <td><%= text_field_tag :studienort %></td>  
		  </tr>

    	<tr>
			  <td><%= label_tag "Studienbeginn:" %></td>
			  <td><%= text_field_tag :studienbeginn %>  </td>
		  </tr>

    	<tr>
			  <td><%= label_tag "Studienende:" %></td>
			  <td><%= text_field_tag :studienende %>  </td>
		  </tr>

    	<tr>
			  <td><%= label_tag "Abschluss:" %></td>
			  <td><%= text_field_tag :abschluss %>  </td>
		  </tr>
      </table>
    	</div>
    	
    	<div id="Gesellschafter">
    	<table style="margin: 10px auto;">
    		<tr>
			    <td><%= label_tag "FA Steuernummer:" %></td>
			    <td><%= text_field_tag :faSteuerNr %>  </td>
		    </tr>

    	<tr>
			  <td><%= label_tag "FA Lfd. Nr.:" %></td>
			  <td><%= text_field_tag :faLfdNr %>  </td>
		  </tr>

    	<tr>
			  <td><%= label_tag "Wohnsitzfinanzamt:" %></td>
			  <td><%= text_field_tag :wohnsitzFinanzamt %>  </td>
		  </tr>

    	<tr>
			  <td><%= label_tag "Notar:" %></td>
			  <td><%= text_field_tag :notarPnr %></td>
			  <td><%= link_to "Suchen...", "#searchOZBPersonFrame", :id => "searchNotarFrame" %></td>
		  </tr>

    	<tr>
			  <td><%= label_tag "Beurkundungsdatum:" %></td>
			  <td><%= text_field_tag :beurkDatum %> </td> 
		  </tr>
		  </table>
    </div>
    	
    <div id="Foerdermitglied">
      <table style="margin: 10px auto;">
    	<tr>
			  <td><%= label_tag "Region" %></td>
			  <td><%= text_field_tag :region %></td>  
		  </tr>

    	<tr>
			  <td><%= label_tag "Förderbeitrag" %></td>
			  <td><%= text_field_tag :foerderbeitrag %>  </td>
		  </tr>
		  </table>
    </div>
    	
    <div id="Mitglied">
      <table style="margin: 10px auto;">
    	<tr>
			  <td><%= label_tag "RV Datum:" %></td>
			  <td><%= text_field_tag :rvDatum %></td>  
		  </tr>
		  </table>
    </div>
    	
    <div id="Partner">
      <table style="margin: 10px auto;">
    	<tr>
			  <td><%= label_tag "Partner:" %></td>
			  <td><%= text_field_tag :partner %>  </td>
			  <td><%= link_to "Suchen...", "#searchOZBPersonFrame", :id => "searchPartnerFrame" %></td>
	    </tr>
		
	    <tr>
			  <td><%= label_tag "Berechtigung" %></td>
			  <td><%= text_field_tag :berechtigung %></td>  
		  </tr>
		  </table>
    </div>
    
  <table style="margin: 10px auto;">
	  <tr>
		  <td><%= label_tag "Antragsdatum:" %></td>
		  <td><%= text_field_tag :antragsdatum %></td>  
	  </tr>
	
	  <tr>
		  <td><%= label_tag "Aufnahmedatum:" %></td>
		  <td><%= text_field_tag :aufnahmedatum %></td>
	  </tr> 
	   
  </table>  
  	<%= link_to_function "Speichern", "this.form.submit()", :onclick => "$('#newForm').submit(); return false;" %>
  
<% end %>

		  <div style="display:none">
		    <div id="searchOZBPersonFrame">
		      <div id="personen"><%= render 'application/suche_ozb_personen' %></div>  
		    </div>
		  </div>

<script>

	var insertId = "#notarPnr";
	
	$("#searchNotarFrame").click(function(){
		insertId = "#notarPnr";
	});
	
	$("#searchPartnerFrame").click(function() {
		insertId = "#partner";
	});
	
	$(document).ready(function() {
	    $("#searchNotarFrame").fancybox();
	    $("#searchPartnerFrame").fancybox();
	});
	
	$(function() {
		var availableTagsB = [
			<% tags = String.new %>
			<% Person.all.each do |person| %>
				<% tags += "'" + person.pnr.to_s + "'" + "," %>
			<% end %>
			<%= tags.chop %>
		];
		$( "#notarPnr" ).autocomplete({
		source: availableTagsB
    	});
	});
	
	$(function() {
		$( "#antragsdatum" ).datepicker({
			dateFormat: 'dd.mm.yy'
 		});
	});
	$(function() {
		$( "#aufnahmedatum" ).datepicker({
			dateFormat: 'dd.mm.yy'
		});
	});
	function show_role()
	{
		$("div#Foerdermitglied").hide();
	    $("div#Student").hide();
    	$("div#Mitglied").hide();
    	$("div#Partner").hide();
    	$("div#Gesellschafter").hide();
	    var role = $('select#rolle').val();
	    switch (role) {
		    case "F":
		    	$("div#Foerdermitglied").show();
		    	break;
		    case "S":
		    	$("div#Student").show();
		    	break;
		    case "G":
		    	$("div#Gesellschafter").show();
		    	break;
		    case "P":
		    	$("div#Partner").show();
		    	break;
		    case "M":
		    	$("div#Mitglied").show();
		    	break;
		    default:
		}		
	}
	show_role();
</script>
