class KontoklasseController < ApplicationController

	before_filter :authenticate_OZBPerson!

  def index
    if current_OZBPerson.canEditD then
      @kontoklassen = Kontenklasse.paginate(:page => params[:page], :per_page => 5)
    else
      redirect_to "/"
    end
  end
  
  def new
    if current_OZBPerson.canEditD then
    else
      redirect_to "/"
    end
  end
  
  def edit
    if current_OZBPerson.canEditD then
      @kontoklasse = Kontenklasse.find(params[:id])
    else
      redirect_to "/"
    end
  end
  
  def save
    if current_OZBPerson.canEditD then
      begin
        @kontoklasse = Kontenklasse.find(params[:kkl])
        @kontoklasse.prozent = params[:prozent]
        @kontoklasse.kklAbDatum = Date.parse(params[:kklAbDatum])
        @kontoklasse.save!
      rescue
          @new_kontoklasse = Kontenklasse.create( :kkl => params[:kkl], :prozent => params[:prozent],
                                                :kklAbDatum => Date.parse(params[:kklAbDatum]) )
          @new_kontoklasse.save!
      end
      
      @kontoklassen = Kontenklasse.all
      redirect_to :action => "index"
    else
      redirect_to "/"
    end
  end
  
  def delete
    if !current_OZBPerson.canEditD then redirect_to "/"  end
    begin
      @kontoklasse = Kontenklasse.find(params[:id])
      @kontoklasse.delete
    rescue
    end
    
    @kontoklassen = Kontenklasse.all    
    redirect_to :action => "index"
  end
  
end
